<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>Vigenère Cipher</title>
    <script src="assets/js/vigenere.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="assets/css/keyboard.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>

    <style>
        .pointer
        {
            cursor: pointer;
        }
        .hr
        {
            border-top: 1px dashed whitesmoke;
            margin: 16px auto;
            width: 75%;
        }
    </style>
</head>
<body>
    <div class="container py-3">
        <nav class="navbar navbar-light bg-light mb-4 shadow rounded">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">
                    Vigenère Cipher
                </a>
                <a class="nav-link" data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                About
                </a>
            </div>
        </nav>
        <div class="collapse" id="collapseExample">
            <div class="card card-body mb-3">
                This project created by Roth In to illustrate the usage of Vigenère cipher. 
                <br><br>
                From Wikipedia, the free encyclopedia:<br><br>

                The Vigenère cipher (French pronunciation: [viʒnɛːʁ]) is a method of encrypting alphabetic text where each letter of the plaintext is encoded with a different Caesar cipher, whose increment is determined by the corresponding letter of another text, the key. <a href="https://en.wikipedia.org/wiki/Vigen%C3%A8re_cipher" target="_blank" class="text-black" rel="noopener noreferrer"> <i class="fa fa-book"></i>read more</a>
                <br><br>
                <a target="_blank" href="https://github.com/rothin1553/vigenere-cipher" class="text-black" role="button"><i class="fa fa-github"></i> GitHub Repository</a>
            </div>
        </div>

        <div class="input-group mb-1">
            <span class="input-group-text" id="basic-addon3">Key Phrases&nbsp;<i class="fa fa-key"></i></span>
            <input autocomplete="off" type="text" class="form-control" placeholder="Enter Key" name="key" id="key" value="defaultkey">
        </div>
        <div class="input-group">
            <span class="input-group-text">Input<i class="fa fa-input-text"></i></span>
            <textarea autocomplete="off" placeholder="Enter Text" class="form-control" rows="4" aria-label="With textarea" name="input" id="input" oninput="convert_char()"></textarea>
        </div>

        <div class="hr" ></div>
        <div class="input-group">
            <span class="input-group-text bg-success text-white" style="font-size: x-small;">Encoded<br>Text</span>
            <textarea placeholder="Encoded Text" class="form-control" readonly rows="4" aria-label="With textarea" id="words"></textarea>
            <span onclick="move_text('words')" class="input-group-text pointer" style="font-size: small;" data-bs-toggle="tooltip" title="Insert texts into input"><i class="fa fa-arrow-up"></i></span>
        </div>
        <div class="input-group mt-1">
            <span class="input-group-text bg-danger text-white" style="font-size: x-small;">Decoded<br>Text</span>
            <textarea placeholder="Decoded Text" class="form-control" readonly rows="4" aria-label="With textarea" id="words_d"></textarea>
            <span onclick="move_text('words_d')" class="input-group-text pointer" style="font-size: small;" data-bs-toggle="tooltip" title="Insert texts into input"><i class="fa fa-arrow-up"></i></span>
        </div>

        <div class="hr" ></div>

        <div class="keyboard mt-3">
            <div class="keyboard__row">
                <div class="key--bottom-left key--word key--w4" data-key="9">
                    <span>tab</span>
                </div>
                <div class="key--letter" data-char="Q">Q</div>
                <div class="key--letter" data-char="W">W</div>
                <div class="key--letter" data-char="E">E</div>
                <div class="key--letter" data-char="R">R</div>
                <div class="key--letter" data-char="T">T</div>
                <div class="key--letter" data-char="Y">Y</div>
                <div class="key--letter" data-char="U">U</div>
                <div class="key--letter" data-char="I">I</div>
                <div class="key--letter" data-char="O">O</div>
                <div class="key--letter" data-char="P">P</div>
                <div class="key--double" data-key="219" data-char="{[">
                <div>{</div>
                <div>[</div>
                </div>
                <div class="key--double" data-key="221" data-char="}]">
                <div>}</div>
                <div>]</div>
                </div>
                <div class="key--double" data-key="220" data-char="|\">
                <div>|</div>
                <div>\</div>
                </div>
            </div>
            <div class="keyboard__row">
                <div class="key--bottom-left key--word key--w5" data-key="20">
                <span>caps lock</span>
                </div>
                <div class="key--letter" data-char="A">A</div>
                <div class="key--letter" data-char="S">S</div>
                <div class="key--letter" data-char="D">D</div>
                <div class="key--letter" data-char="F">F</div>
                <div class="key--letter" data-char="G">G</div>
                <div class="key--letter" data-char="H">H</div>
                <div class="key--letter" data-char="J">J</div>
                <div class="key--letter" data-char="K">K</div>
                <div class="key--letter" data-char="L">L</div>
                <div class="key--double" data-key="186">
                <div>:</div>
                <div>;</div>
                </div>
                <div class="key--double" data-key="222">
                <div>"</div>
                <div>'</div>
                </div>
                <div class="key--bottom-right key--word key--w5" data-key="13">
                <span>return</span>
                </div>
            </div>
            <div class="keyboard__row">
                <div class="key--bottom-left key--word key--w6" data-key="16">
                <span>shift</span>
                </div>
                <div class="key--letter" data-char="Z">Z</div>
                <div class="key--letter" data-char="X">X</div>
                <div class="key--letter" data-char="C">C</div>
                <div class="key--letter" data-char="V">V</div>
                <div class="key--letter" data-char="B">B</div>
                <div class="key--letter" data-char="N">N</div>
                <div class="key--letter" data-char="M">M</div>
                <div class="key--double" data-key="188">
                <div>&lt;</div>
                <div>,</div>
                </div>
                <div class="key--double" data-key="190">
                <div>&gt;</div>
                <div>.</div>
                </div>
                <div class="key--double" data-key="191">
                <div>?</div>
                <div>/</div>
                </div>
                <div class="key--bottom-right key--word key--w6" data-key="16-R">
                <span>shift</span>
                </div>
            </div>
        </div>
    </div>
    <footer class="mt-5"><p class="text-center text-muted">Created since 2024 | Roth P. In.</p></footer>
    <script>
        function calculate(decode=false)
        {
            let key = document.getElementById("key").value;
            let input = document.getElementById("input").value;
            let data = encode(key, input, decode);

            document.getElementById("output").innerHTML = data;
        }

        function getKey (e) {
            var location = e.location;
            var selector;
            if (location === KeyboardEvent.DOM_KEY_LOCATION_RIGHT) {
                selector = ['[data-key="' + e.keyCode + '-R"]']
            } else {
                var code = e.keyCode || e.which;
                selector = [
                    '[data-key="' + code + '"]',
                    '[data-char*="' + encodeURIComponent(String.fromCharCode(code)) + '"]'
                ].join(',');
            }
            return document.querySelector(selector);
        }

        function pressKey (char) {
            var key = document.querySelector('[data-char*="' + char.toUpperCase() + '"]');
            if (!key) {
                return false//console.warn('No key for', char);
            }
            key.setAttribute('data-pressed', 'on');
            setTimeout(function () {
                key.removeAttribute('data-pressed');
            }, 200);
        }

        function pressKey_encode (char, decode=false) {
            var key = document.querySelector('[data-char*="' + char.toUpperCase() + '"]');
            if (!key) {
                return false//console.warn('No key for', char);
            }
            key.setAttribute("data-pressed", "on");
            if(decode)
            {
                $(key).addClass("bg-danger");
            }
            else
            {
                $(key).addClass("bg-success");
            }
            
            setTimeout(function () {
                $(key).removeClass("bg-danger bg-success");
                key.removeAttribute('data-pressed');
            }, 500);
        }

        

        document.body.addEventListener('keydown', function (e) {
            var key = getKey(e);
            if (!key) {
                return false//console.warn('No key for', e.keyCode);
            }

            key.setAttribute('data-pressed', 'on');
        });

        document.body.addEventListener('keyup', function (e) {
            var key = getKey(e);
            key && key.removeAttribute('data-pressed');
        });

        function size () {
            var size = keyboard.parentNode.clientWidth / 65;
            keyboard.style.fontSize = size + 'px';
            //console.log(size);
        }

        var keyboard = document.querySelector('.keyboard');
        window.addEventListener('resize', function (e) {
            size();
        });
        size();


        function convert_char()
        {
            if(!document.getElementById("key").value)
            {
                alert("Key is required. Please input the key.");
                $("#key").focus();
            }
            var data = encode(document.getElementById("key").value, document.getElementById("input").value);
            var data_d = encode(document.getElementById("key").value, document.getElementById("input").value, true);
            if(document.getElementById("input").value)
            {
                // document.getElementById("character").innerText   = "Encode: " + data[data.length-1];
                // document.getElementById("character_d").innerText = "Decode: " + data_d[data_d.length-1];
                pressKey_encode(data[data.length-1]);
                pressKey_encode(data_d[data_d.length-1], true);
                document.getElementById("words").value       = data;
                document.getElementById("words_d").value     = data_d;
            }
            else
            {
                // document.getElementById("character").innerText = "-";
                // document.getElementById("character_d").innerText = "-";
                document.getElementById("words").value = "";
                document.getElementById("words_d").value = "";
            }
            //console.log(data);
        }

        $(".key--letter").on("click", function(){
            let ch = $(this).data("char").toLowerCase();
            console.log(ch);
            //$("#input").val($("#input").val() + ch).trigger("keyup");
            $("#input").val($("#input").val() + ch).trigger("input");
        });

        $(document).ready(function(){
            $('[data-bs-toggle="tooltip"]').tooltip();
        });
        function move_text(id)
        {
            $("#input").val($("#"+id).val()).trigger("input");
        }
    </script>
</body>
</html>
